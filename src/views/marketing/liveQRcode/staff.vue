<template>
  <section class="staff">
    <p class="desc">新建员工活码后，客户可以通过扫描活码添加成员好友，自动给客户打标签和发送欢迎语。</p>
    <a-button type="primary" @click="createEmployeeCode">新建员工活码</a-button>

    <a-divider />
    <a-form class="form" layout="inline">
      <a-form-item label="活码名称">
        <a-input placeholder="请输入活码名称" />
      </a-form-item>
      <a-form-item label="创建人">
        <a-select ref="select" :value="selectCreator" style="width: 120px" @change="handleChange">
          <a-select-option value="jack">Jack</a-select-option>
          <a-select-option value="lucy">Lucy</a-select-option>
          <a-select-option value="disabled" disabled>Disabled</a-select-option>
          <a-select-option value="Yiminghe">yiminghe</a-select-option>
        </a-select>
      </a-form-item>
      <a-form-item label="创建时间">
        <a-range-picker />
      </a-form-item>
      <a-form-item label="使用员工">
        <a-select ref="select" :value="selectUseStaff" style="width: 120px" @change="handleChange">
          <a-select-option value="jack">Jack</a-select-option>
          <a-select-option value="lucy">Lucy</a-select-option>
          <a-select-option value="disabled" disabled>Disabled</a-select-option>
          <a-select-option value="Yiminghe">yiminghe</a-select-option>
        </a-select>
      </a-form-item>
      <a-button type="primary">查询</a-button>
    </a-form>
    <!-- <a-divider orientation="left">表格展示：</a-divider> -->
    <div class="table-operations">
      <a-button>下载</a-button>
      <a-button>删除</a-button>
    </div>
    <a-table
      :locale="locale"
      :columns="columns"
      :rowKey="(record) => record.login.uuid"
      :rowSelection="rowSelection"
      :dataSource="data"
      :pagination="pagination"
      :loading="loading"
      @change="handleTableChange"
    >
      <template slot="name" slot-scope="name"> {{ name.first }} {{ name.last }} </template>
    </a-table>
  </section>
</template>

<script>
import { getList } from '@/api/example/table'

const columns = [
  {
    title: '全部活码',
    dataIndex: 'name',
    sorter: true,
    width: '20%',
    scopedSlots: { customRender: 'name' },
  },
  {
    title: '创建人',
    dataIndex: 'gender',
    filters: [
      { text: 'Male', value: 'male' },
      { text: 'Female', value: 'female' },
    ],
    width: '20%',
  },
  {
    title: '使用员工',
    dataIndex: 'email1',
    ellipsis: true,
  },
  {
    title: '总客户数',
    dataIndex: 'email2',
    ellipsis: true,
  },
  {
    title: '昨日新增客户数',
    dataIndex: 'email3',
    ellipsis: true,
  },
  {
    title: '创建日期',
    dataIndex: 'email4',
    ellipsis: true,
  },
  {
    title: '操作',
    dataIndex: 'email5',
    ellipsis: true,
  },
]
export default {
  name: 'StaffCode',
  components: {},
  data() {
    return {
      data: [],
      pagination: {
        showSizeChanger: true,
      },
      loading: false,
      columns,
      locale: {
        emptyText: '数据加载中...',
      },
      current: ['staff'],
      selectCreator: '', // 选择创建人
      selectUseStaff: '',
    }
  },
  computed: {
    noData() {
      return this.data.length === 0
    },
    rowSelection() {
      return {
        onChange: (selectedRowKeys, selectedRows) => {
          console.log(`selectedRowKeys: ${selectedRowKeys}`, 'selectedRows: ', selectedRows)
        },
        getCheckboxProps: (record) => ({
          // props: {
          //   disabled: record.name === 'Disabled User', // Column configuration not to be checked
          //   name: record.name,
          // },
        }),
      }
    },
  },
  watch: {},
  mounted() {
    this.getList()
  },
  methods: {
    // 新建员工活码
    createEmployeeCode() {
      this.$router.push('addEmployee')
    },
    // 选择创建人
    handleChange(value) {
      this.selectCreator = value
    },
    handleTableChange(pagination, filters, sorter) {
      // console.log(pagination)
      const pager = { ...this.pagination }
      pager.current = pagination.current
      this.pagination = pager
      this.getList({
        results: pagination.pageSize,
        page: pagination.current,
        sortField: sorter.field,
        sortOrder: sorter.order,
        ...filters,
      })
    },
    getList(params = {}) {
      this.loading = true
      getList({ results: 10, ...params })
        .then((res) => {
          const pagination = { ...this.pagination }
          pagination.total = 100
          this.loading = false
          this.data = res.results
          this.pagination = pagination
        })
        .finally((f) => {
          this.locale.emptyText = '暂无数据'
        })
    },
    resetList() {
      this.data = []
      this.pagination = {
        showSizeChanger: true,
        total: 0,
      }
      this.loading = false
    },
  },
}
</script>
<style scoped lang="less">
@import url('@/style/marketing/liveQRcode/staff.less');
</style>
